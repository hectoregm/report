\chapter{Diseño e implementación del sistema PEAT}

Para lograr el objetivo del sistema \texttt{PEAT} se dividió en cuatro
módulos principales con las siguientes características generales:

\begin{itemize}
\item Perfil sencillo de local (\textit{Simple Building Profile}): en este modulo realiza
  la configuración inicial del local del usuario, realizando solamente un numero limitado
  de preguntas básicas.
\item Perfil detallado de local (\textit{Detailed Building Profile}): en este modulo se
  encarga del ingreso y/o actualización de las características de un edificio/local.
\item Plan de ahorro de energía (\textit{Energy Savings Plan}): en este modulo se
  presenta el consumo de energía de usuario, también debe manejar las recomendaciones
  que el usuario se ha comprometido a poner en practica.
\item Recomendaciones (\textit{Recommendations}): en este modulo se genera una lista
  de medidas de ahorro de energía considerando la información básica y detallada
  ingresada al sistema hasta el momento. Aparte debe permitir al usuario obtener
  información detallada sobre las recomendaciones presentadas.
\end{itemize}

Como se puede ver el modelo de local/edificio es el principal modelo dentro de
\texttt{PEAT}, por lo que lograr obtener una correcta correspondencia entre
el consumo energético y un local dado es de vital importancia para dar la
información mas pertinente al usuario.

\section{Modelo de información}

El objetivo principal del modelo de información de \texttt{PEAT} es definir el
concepto de edificio y su relación con el consumo energético del usuario. Así en
\texttt{PEAT} tenemos el concepto de local/edificio el cual es una estructura
independiente a la cual se le esta proporcionando un servicio eléctrico o de gas.

\subsection{Estructura de facturación de PG\&E}
Un usuario puede tener una o varias cuentas, a su vez cada cuenta puede tener uno o varios
contratos de servicio. Un contrato de servicio representa los servicios que el usuario
requiere ya sea de electricidad o gas. Una cuenta también tiene una o varias direcciones de
servicio.
Cada una de estas direcciones tiene uno o varios puntos de servicio. Finalmente un punto
de servicio puede tener uno varios medidores. Un medidor es un dispositivo instalado en un
punto de servicio que registra el consumo del servicio, ya sea eléctrico o gas, por el local
(Ver Figura 3.1).

\jcimage{1.0}{imagenes/PGE-facturacion.png}{Modelos principales para la facturación en PG\&E.}

El usuario, la cuenta y el contrato de servicio representan el lado demográfico de modelo de
información, la cual cambia bastante.

\begin{itemize}
\item Usuario: representa al cliente, puede tener uno o más cuentas.
\item Cuenta: representa la contabilidad financiera del cliente. Puede
  tener uno o más contratos de servicio, uno por tipo (eléctrico o gas),
  también tiene una o más direcciones de servicio.
\item Contrato de servicio: representa los servicios que el cliente adquiere
  de PG\&E, como la electricidad o el gas, puede tener uno o mas puntos
  de servicio asociados.
\end{itemize}

La dirección de servicio, el punto de servicio y el medidor representan la parte geográfica
del modelo de información, esta información raramente cambia:

\begin{itemize}
\item Dirección de servicio: es una ubicación física en donde se prestan los servicios, en
  PEAT son el modelo que se quiere asociar al modelo de local/edificio, puede tener
  uno o más puntos de servicio.
\item Punto de servicio: es una coordenada geográfica en donde se conectan los servicios,
  puede tener uno o más medidores.
\item Medidor: es un dispositivo instalado en un punto de servicio que registra el
  consumo del servicio.
\end{itemize}


Para que \texttt{PEAT} pueda darlas mejores recomendaciones al usuario para reducir su consumo
energético es necesario definir claramente la relación entre un local/edificio y su consumo
energético medido por uno o varios medidores.

\subsection{Relación Edificio-Facturación}
El modelo de información expuesto presenta un gran reto para lograr los objetivos del sistema,
puesto que es necesario definir la relación entre un local y su consumo energetico real.

\section{Casos de uso}

\subsection{Diagrama general}

En el Figura 3.2 se muestra el diagrama general de casos de uso del sistema
\texttt{PEAT}. Se tienen 8 casos de uso para \texttt{PEAT} con tres casos de uso
para la libreria \texttt{Bezel}. Los casos de uso se agrupan en los cuatro modulos
principales mencionados anteriormente:

\begin{itemize}
\item Perfil sencillo de local (\textit{Simple Building Profile}): Tiene
  solo el caso de uso \textit{Crear perfil del edificio} pero este caso de uso
  es uno de los mas complejos en cuestión de interacción con el usuario y su
  importancia para obtener las características iniciales del edificio.
\item Perfil detallado de local (\textit{Detailed Building Profile}): Contiene
  los casos de uso
\end{itemize}

\jcimage{1.0}{imagenes/Diagrama-General-CasosDeUso.png}{Diagrama general de casos de uso de \texttt{PEAT}.}

\section{Interfase de usuario}
Dentro de los requerimientos del proyecto PEAT se tenia la implementación de una
interfaz de usuario que fuera lo suficientemente eficaz y sencilla, para así obtener
la mayor cantidad de información del usuario.

\subsection{Configuración inicial}

Los datos de facturación del consumo eléctrico de un cliente no puede ser analizados
para obtener el numero de edificios (y sus características) a los cuales se les
proporciona el servicio eléctrico. No se tienen métodos fiables que permitan
usar solamente los datos de facturación para obtener esta información, así es
necesario que el usuario responda una serie de preguntas básicas sobre sus edificios.

Para dar el mayor valor al usuario es necesario obtener al menos la siguiente información
para cada cuenta:

\begin{enumerate}
\item La industria que mejor describe el negocio del usuario.
\item El numero de edificios.
\end{enumerate}

Ademas por cada edificio era necesario obtener al menos la siguiente información:

\begin{enumerate}
\item El tamaño del edificio (área).
\item El tipo de edificio.
\item La dirección de servicio asociada al edificio.
\end{enumerate}

Obteniendo al menos esta información era factible el dar un valor al usuario desde el
principio, entonces se tenia un énfasis en la interfase de usuario en el primer ingreso
del usuario.

Se tenia un énfasis en la interfase de usuario en el primer ingreso del usuario puesto
que era critico obtener al menos la siguiente información:

\begin{usecase}
  \addtitle{Caso de Uso I:}{Crear perfil inicial de un edificio.}
  \addfield{Descripción:}{Un cliente PyME entra al sistema  para crear un perfil inicial
    de un edificio, respondiendo ciertas preguntas básicas sobre el edificio.}
  \addfield{Actor:}{Cliente PyME}
  \additemizedfield{Precondiciones:}{
  \item El usuario a sido autentificado por medio de un token SSO (Single Sign On)
    asignado por el sistema de PG\&E.
  \item Los datos de intervalo y de facturación del cliente esta en el sistema.
  }
  \addscenario{Flujo normal:}{
  \item El sistema checa si el cliente tiene mas de una cuenta.
  \item El sistema despliega el numero de cuenta.
  \item El usuario puede definir un alias a la cuenta.
  \item El sistema despliega las direcciones de servicio asociadas a la cuenta.
  \item El cliente debe ingresar la siguiente información sobre el edificio:
    \begin{enumerate}
    \item Tipo.
    \item Rango de tamaño.
    \item Antigüedad.
    \end{enumerate}
  \item El usuario puede ingresar los datos o cancelar.
  }
  \addfield{Postcondiciones:}{
    Se genera un identificador único para el perfil del edificio generado, el cual
    esta asociado a los datos de facturación de la cuenta del cliente PyME.
  }
\end{usecase}
