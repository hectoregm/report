\documentclass{article}
\usepackage[left=4cm,right=4cm,top=4cm,bottom=4cm,letterpaper]{geometry}
\usepackage[spanish]{babel}
\usepackage[utf8]{inputenc}
\author{Héctor E. Gómez Morales}
\title{Reporte Trabajo Profesional: Proyecto PEAT (Progressive Energy
  Audit Tool)}
\begin{document}
\maketitle
\tableofcontents
\section{Introducción}
Este reporte se enfoca al diseño e implementación de la aplicación
PEAT (Progressive Energy Audit Tool) que es una aplicación web que
ayuda a usuarios de PyMES identificar y monitorear su gasto en
energía, para de esta forma darle un mayor control en sus costos de
energía.

PEAT es producto de una licitación auspiciada por Pacific Gas and
Electric Company (PG\&E), proveedora de gas natural y electricidad
para casi dos tercios del norte de California, USA, para
el desarrollo de una aplicación web enfocada a usuarios PyMES.

Su desarrollo era de importancia critica para PG\&E y al gobierno de
California puesto que su funcionamiento era un requisito en una nueva
ley de facturación de energía eléctrica en 2013. La nueva ley buscaba
lograr distribuir la carga de la red eléctrica, una de las formas
principales para lograr esto era desincentivar el uso de la red
eléctrica en horas picos al darle la facultad a las utilidades como PG\&E
de cobrar tasas mucho mas altas en estas horas.
\section{Planteamiento del problema}
Aunque PG\&E tiene todos los datos de consumo eléctrico y/o gas de
sus clientes, y dado el despliegue previo de los nuevos medidores
inteligentes en la mayor parte de sus clientes se tenia acceso a
información muy detallada del consumo de energía.

Para darle la mayor información y valor a las empresas era
vital obtener mayor contexto de su entorno de operación: numero
de edificios asociados a la cuenta, rubro de la empresa, numero de
empleados, etc. Entre mayor información se pudiera captar sobre la
empresa el sistema daría un desglose mas detallado y útil de sus
consumos de energía. El objetivo era dar la mayor utilidad posible con
la menor información disponible pero fomentando al usuario el dar
mas información para darle un mejor monitoreo de su consumo.

La compañía C3 Energy, en la que trabaje y que gano esta licitación,
contaba con la infraestructura para el procesamiento de una gran
cantidad de datos de consumo de energía puesto que tenia un sistema
de monitoreo de consumo de energía pero enfocada a empresas de nivel
multinacional. El reto era que se pasaba de tener una docena
de clientes, con los cuales se trataba directamente, a lidiar con
cientos de miles de empresas PyMES en las cuales se obtenía una
parte de la información por parte de PG\&E y otra parte por el
empresario.

En resumen el sistema tenia los siguientes principales requerimientos:
\begin{itemize}
\item Tiene que tener una interfase web, usando como autentificacion
  sus credenciales de acceso en el portal web de PG\&E
\item El sistema debe dar información útil aunque el usuario solo de
  el mínimo de información sobre su empresa.
\item El sistema debe proporcionar recomendaciones para disminuir sus
  gastos en energía en base a su consumo e información proporcionada
  hasta el momento
\item Soportar por lo menos a mil usuarios concurrentes
\end{itemize}
\section{Arquitectura}
En C3 tenian ya una infraestructura para el procesamiento de datos de
consumo electrico y de gas. Su sistema hacia un compendio de varias
bases de datos externas relacionadas con temas de energia, todo esto era
concentrado en una base de datos central en la que se usaba Oracle
Database 10g para este rol. Tambien se contaba con un cluster de
Apache Cassandra lo cuales se usaban para realizar el procesamiento
inicial de los datos y realizar analisis posteriores.

Sobre esta capa de datos se tenia un API que que permitia el
hacer consultas y operaciones sobre los datos contenidos en este
sistema. Este API estaba implementado en Javascript bajo la maquina
Rhino que corre en JVM, por lo que ciertas rutinas criticas se
fueron reimplementando en Java.

Su aplicacion para empresas multinacionales involucraba un single page
application implementado con Javascript. Dado que el backend tenia
una jerarquia de objectos en javascript esta jerarquia era serializada
y reconstruida en el navegador del usuario, haciendose un gran reuso
de codigo. Tambien se hacia un uso extenso de la biblioteca Ext JS
que es un framework en Javascript para construir grandes aplicaciones
del tipo rich application, se hacia particularmente uso de la creacion
de graficas de todo tipo para la interfase de usuario del cliente.

Entonces tenemos que tanto en el frontend como en el backend se hacia
uso de Javascript principalmente con un nucleo de Java para las partes
que requerian un rendimiento optimo. Esto tenia varias ventajas:

\begin{itemize}
\item Reducir al minimo el cambio de contexto entre lenguajes entre
  el frontend y el backend
\item Reducir sustancialmente la cantidad de codigo redudante al no
  tenerse que reimplementar la jerarquia de objetos, que era pasada
  por el server en forma serializada por JSON y deserializada por el
  cliente
\item Habia una unica representacion de una clase por ejemplo la
  clase de edificios la misma clase de Javascript que se usaba para
  esta representacion era usada tanto en el server como en el
  cliente.
\end{itemize}

En primera instancia se pensaba realizar el mismo tipo de aplicacion
para cubrir los requerimientos de PEAT, es decir realizar un cliente
de Javascript que hiciera uso del API y jerarquia de objetos ya
existente (con varias adicciones y modificaciones) y de Ext JS
para la interfase de usuario. Pero en los primeros prototipos se
lograron visualizar varios problemas con este acercamiento:
\begin{itemize}
\item El tiempo para realizar la precarga de todos los modulos y
  objetos dados por el API en el cliente tomaba un tiempo
  considerable (5+ secs) dado que este sistema era usado por un muy
  reducido numero de personas y que cuando era cargado era usado
  extensamente este penalty por arranque era tolerable
\end{itemize}
\end{document}
