\chapter{Fundamentos teóricos}

\section{Patrón Modelo-Vista-Controlador (MVC)}
El patrón Modelo Vista Controlador (\texttt{MVC}) es probablemente el patrón
mas utilizado y citado para el desarrollo de interfaces de usuario y sistemas web.
\texttt{MVC} consiste de tres tipos de objetos:

\begin{itemize}
\item Modelo: Representación de la información de dominio del sistema.
\item Vista: Representación visual del modelo.
\item Controlador: Define la forma en que la interfaz reacciona a la entrada
  del usuario.
\end{itemize}

\jcimage{1.0}{imagenes/MVC-Rails.png}{Patrón MVC en Rails.}

Su uso extensivo se da porque permite una clara división de responsabilidades
entre la presentación (vista y controlador) y el dominio (modelo).
\texttt{MVC} desacopla vistas y modelos mediante el establecimiento de un
protocolo de suscribirse / notificar entre ellos. La vista debe asegurarse
de que su aspecto visual refleje el estado del modelo. Cada vez que cambian
los datos del modelo, el modelo notifica a las vistas que depende de ella.
Este enfoque permite conectar múltiples vistas a un modelo para proporcionar
diferentes presentaciones. También puede crear nuevas vistas para un modelo
sin reescribir este ultimo \cite[pag.~4]{14_gamma_1995}.

\subsection{MVC y Rails}
\texttt{MVC} fue ideado originalmente para aplicaciones gráficas convencionales,
donde los desarrolladores encontraron que la separación de responsabilidades
fomentadas por el patrón llevan a un menor acoplamiento lo que hacia al código
mucho mas fácil de escribir y mantener.

En el marco de trabajo Rails se hace uso de \texttt{MVC} como patrón de arquitectura
para construir sistemas web. En Rails se los modelos se definen haciendo
uso de la biblioteca \texttt{ActiveRecord}, esta biblioteca implementa una capa
de \textit{Object-relational mapping} (\texttt{ORM}) para facilitar el acceso
de información contenida en bases de datos relacionales, dado que es el caso
típico en sistemas web convencionales.

En Rails, la vista es responsable de la creación de la totalidad o parte de la
respuesta dada para ser mostrada en un navegador. En su forma mas simple, una
vista es un trozo de código \texttt{HTML} que muestra un texto fijo. Mas típicamente
se requiere mostrar contenido dinámico creado por una acción en un controlador.
El contenido dinámico es generado por medio de plantillas, el esquema
de plantillas más común es llamada \textit{Embedded Ruby} (\texttt{ERB}),
el cual inserta pedazos de código Ruby dentro de una vista, similar a la forma
como se hace en otros marcos de trabajo como PHP o JSP. También se pude hacer uso de
\texttt{ERB} para construir pedazos de código Javascript en el servidor
para ser ejecutados en el servidor, lo cual permite crear interfases
dinámicas haciendo uso \texttt{AJAX}.

Finalmente en Rails los controladores son el centro lógico del sistema. Coordina
la interacción entre el usuario, las vistas y el modelo \cite[pag.~29]{15_agile_hansson}.

\subsection{MVC y PEAT}
\texttt{PEAT} saca provecho de \texttt{MVC} de las siguientes maneras:

\begin{enumerate}
\item Modelo: Dado que en un principio los servicios web de recomendaciones y
  disagregacion estaban en construcción se hizo uso de \texttt{ActiveRecord}
  para tener datos reales pero estáticos para permitir la implementación
  de la interfaz de usuario. Posteriormente se reemplazaron estos modelos
  por nuevos modelos que hacían uso de los servicios web del \textit{backend},
  por medio de la biblioteca \texttt{Bezel}. Dado que hay un desacoplamiento
  entre los modelos y las vistas esto no implico grandes cambios al hacer el
  reemplazo.
\item Vista: Haciendo uso de plantillas se generan representaciones \texttt{HTML}
  y \texttt{JSON} de los principales modelos del sistema. Para ciertos modelos se
  tenia una tercera representación en forma de \texttt{PDF} del modelo.
\end{enumerate}

\section{Servicios web RESTful}
La Transferencia de Estado Representacional (Representational State Transfer) o
REST es un estilo de arquitectura software para sistemas hipermedia distribuidos
como la World Wide Web. El término se originó en el año 2000, en una tesis doctoral
sobre la web escrita por Roy Fielding, uno de los principales autores de la
especificación del protocolo HTTP y ha pasado a ser ampliamente utilizado por
la comunidad de desarrollo.
